System.register("chunks:///_virtual/AnimationMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,r,o,a,i,s,c,l,p;return{setters:[function(e){t=e.inheritsLoose,n=e.classPrivateFieldLooseBase,r=e.classPrivateFieldLooseKey,o=e.assertThisInitialized},function(e){a=e.cclegacy,i=e._decorator,s=e.AnimationClip,c=e.animation,l=e.Sprite,p=e.Component}],execute:function(){var u,d;a._RF.push({},"50bddK+6B9E4Y+c1Bh8fJib","AnimationMgr",void 0);var h=i.ccclass;i.property,e("AnimationMgr",h("AnimationMgr")((d=r("map"),u=function(e){function r(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,Object.defineProperty(o(t),d,{writable:!0,value:new Map}),t}return t(r,e),r.prototype.createAnimation=function(e){var t=e.sfs,r=e.name,o=e.gap,a=void 0===o?.1:o,i=e.mode,p=void 0===i?s.WrapMode.Loop:i;if(n(this,d)[d].has(r))return n(this,d)[d].get(r);var u=t.concat(t[0].clone());console.log("制作动画帧",r,u.length);var h=new s;h.duration=a*u.length;var m=new c.ObjectTrack;return m.path.toComponent(l).toProperty("spriteFrame"),m.channels()[0].curve.assignSorted(u.map((function(e,t){return[t*a,e]}))),h.addTrack(m),h.wrapMode=p,h.name=r,n(this,d)[d].set(r,h),h},r}(p)))||u);a._RF.pop()}}}));

System.register("chunks:///_virtual/app.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AudioMgr.ts","./GameMgr.ts","./AnimationMgr.ts","./toast.ts"],(function(n){var e,t,o,r,i,a,c,s,p,u,l,d,f,y;return{setters:[function(n){e=n.applyDecoratedDescriptor,t=n.inheritsLoose,o=n.initializerDefineProperty,r=n.assertThisInitialized},function(n){i=n.cclegacy,a=n._decorator,c=n.find,s=n.Node,p=n.director,u=n.Component},function(n){l=n.AudioMgr},function(n){d=n.GameMgr},function(n){f=n.AnimationMgr},function(n){y=n.setup}],execute:function(){var g,m,v,h,M;i._RF.push({},"ace1fEj645GyasVl561BH40","app",void 0);var P=a.ccclass,A=a.property;n("app",(g=P("app"),m=A({displayName:"初始游戏入口"}),g((M=e((h=function(n){function e(){for(var e,t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return e=n.call.apply(n,[this].concat(i))||this,o(e,"entryPoint",M,r(e)),e}t(e,n);var i=e.prototype;return i.onLoad=function(){if(!c("ref")){var n=new s("ref");p.addPersistRootNode(n),n.addComponent(l),n.addComponent(d),n.addComponent(f),y(n),console.log("APP Mount")}},i.onEnable=function(){var n=this;console.log("START NODE MOUNT");var e=c("ref").getComponent(d);e.ready?p.loadScene(this.entryPoint):e.node.once("ready",(function(){p.loadScene(n.entryPoint)}))},e}(u)).prototype,"entryPoint",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"menu"}}),v=h))||v));i._RF.pop()}}}));

System.register("chunks:///_virtual/AudioMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var o,e,i,n,r,s,a,c,u,l;return{setters:[function(t){o=t.inheritsLoose,e=t.classPrivateFieldLooseBase,i=t.classPrivateFieldLooseKey,n=t.assertThisInitialized},function(t){r=t.cclegacy,s=t._decorator,a=t.AudioSource,c=t.resources,u=t.AudioClip,l=t.Component}],execute:function(){var p,d,h,f;r._RF.push({},"8d539/DQaNDDrZ/q9DbqtrT","AudioMgr",void 0);var v=s.ccclass;s.property,t("AudioMgr",v("AudioMgr")((d=i("audioSource"),h=i("effect"),f=i("map"),p=function(t){function i(){for(var o,e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];return(o=t.call.apply(t,[this].concat(i))||this).count=0,Object.defineProperty(n(o),d,{writable:!0,value:void 0}),Object.defineProperty(n(o),h,{writable:!0,value:void 0}),Object.defineProperty(n(o),f,{writable:!0,value:new Map}),o}o(i,t);var r=i.prototype;return r.onLoad=function(){var t=this;e(this,d)[d]=this.node.addComponent(a),e(this,h)[h]=this.node.addComponent(a),c.loadDir("audio",u,(function(o,i){o||i.forEach((function(o){e(t,f)[f].set(o.name,o)}))}))},r.play=function(t,o){void 0===o&&(o=.3),e(this,d)[d].clip=e(this,f)[f].get(t),e(this,d)[d].loop=!0,e(this,d)[d].volume=o,e(this,d)[d].play()},r.stop=function(){e(this,d)[d].stop(),e(this,d)[d].clip=null,e(this,d)[d].loop=!1},r.effectPlay=function(t,o){void 0===o&&(o=.5);var i=e(this,f)[f].get(t);e(this,h)[h].playOneShot(i,o)},r.stopAll=function(){e(this,d)[d].stop(),e(this,h)[h].stop()},i}(l)))||p);r._RF.pop()}}}));

System.register("chunks:///_virtual/Base.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameMgr.ts","./AudioMgr.ts","./AnimationMgr.ts"],(function(t){var o,n,e,i,r,a,c,s;return{setters:[function(t){o=t.inheritsLoose},function(t){n=t.cclegacy,e=t._decorator,i=t.find,r=t.Component},function(t){a=t.GameMgr},function(t){c=t.AudioMgr},function(t){s=t.AnimationMgr}],execute:function(){var u;n._RF.push({},"bc12eXaeAtKkaXCVZ+UdAt2","Base",void 0);var f=e.ccclass;e.property,t("Base",f("Base")(u=function(t){function n(){for(var o,n=arguments.length,e=new Array(n),i=0;i<n;i++)e[i]=arguments[i];return(o=t.call.apply(t,[this].concat(e))||this).rootMgr=void 0,o.audio=void 0,o.game=void 0,o.animation=void 0,o}o(n,t);var e=n.prototype;return e.onLoad=function(){this.rootMgr=i("ref"),this.audio=this.rootMgr.getComponent(c),this.game=this.rootMgr.getComponent(a),this.animation=this.rootMgr.getComponent(s)},e.effectPlayFromUI=function(t,o){this.effectPlay(o)},e.effectPlay=function(t){this.audio.effectPlay(t)},n}(r))||u);n._RF.pop()}}}));

System.register("chunks:///_virtual/Block.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameMgr.ts","./Base.ts","./Bullet.ts"],(function(e){var t,o,n,i,r,s,l,c,u,a,p,h,f;return{setters:[function(e){t=e.inheritsLoose,o=e.classPrivateFieldLooseBase,n=e.classPrivateFieldLooseKey,i=e.assertThisInitialized},function(e){r=e.cclegacy,s=e._decorator,l=e.BoxCollider2D,c=e.Contact2DType,u=e.Sprite},function(e){a=e.BLOCK,p=e.ContactGroup},function(e){h=e.Base},function(e){f=e.Bullet}],execute:function(){var d,g,B,m,C;r._RF.push({},"89d6dcK9qpAe50GJl2SmGZ7","Block",void 0);var v=s.ccclass;s.property,e("Block",v("Block")((g=n("cld"),B=n("type"),m=n("onCollider"),C=n("changeBrokenTexture"),d=function(e){function n(){for(var t,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t=e.call.apply(e,[this].concat(r))||this,Object.defineProperty(i(t),C,{value:y}),Object.defineProperty(i(t),g,{writable:!0,value:void 0}),Object.defineProperty(i(t),B,{writable:!0,value:void 0}),Object.defineProperty(i(t),m,{writable:!0,value:function(e,n,r){var s;((n.group===p.BULLET||n.group===p.ENEMY_BULLET)&&-1!==[a.Wall,a.Ice,a.Camp].indexOf(o(i(t),B)[B])||o(i(t),B)[B]===a.Stone&&n.group===p.BULLET&&null!=(s=n.node)&&null!=(s=s.parent)&&null!=(s=s.getComponent(f))&&s.brokenStone)&&(o(i(t),g)[g].off(c.BEGIN_CONTACT,o(i(t),m)[m]),o(i(t),B)[B]===a.Camp?(o(i(t),C)[C](),t.scheduleOnce((function(){t.audio.stop(),o(i(t),B)[B]===a.Camp&&(t.node.destroy(),t.game.gameOver())}),1)):t.scheduleOnce((function(){return t.node.destroy()})))}}),t._stonezile=function(){o(i(t),B)[B]=a.Wall,t.getComponent(u).spriteFrame=t.game.getBlockTexture(a.Wall)},t}t(n,e);var r=n.prototype;return r.onEnable=function(){o(this,g)[g]=this.getComponent(l),o(this,g)[g].on(c.BEGIN_CONTACT,o(this,m)[m])},r.onDisable=function(){o(this,g)[g].off(c.BEGIN_CONTACT,o(this,m)[m]),this.unschedule(this._stonezile)},r.stonezile=function(){o(this,B)[B]=a.Stone,this.getComponent(u).spriteFrame=this.game.getBlockTexture(a.Stone),this.unschedule(this._stonezile),this.scheduleOnce(this._stonezile,8)},r.setBlockType=function(e){o(this,B)[B]=e,e===a.Forest?o(this,g)[g].group=p.FOREST:e===a.River&&(o(this,g)[g].group=p.RIVER)},r.onDestroy=function(){},n}(h)))||d);function y(){this.audio.effectPlay("use_bomb"),this.getComponent(u).spriteFrame=this.game.getBlockTexture(a.Camp_BROKEN)}r._RF.pop()}}}));

System.register("chunks:///_virtual/Bonus.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameMgr.ts","./Base.ts","./Player.ts","./Data.ts"],(function(e){var n,t,o,a,r,i,s,l,c,u,d,p,h,m,f,b,g,v,y,B;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,a=e.assertThisInitialized,r=e.createForOfIteratorHelperLoose},function(e){i=e.cclegacy,s=e._decorator,l=e.Rect,c=e.Prefab,u=e.math,d=e.instantiate,p=e.Sprite,h=e.Collider2D,m=e.sys,f=e.Contact2DType},function(e){b=e.BONUS,g=e.GameMgr},function(e){v=e.Base},function(e){y=e.Player},function(e){B=e.Data}],execute:function(){var E,L,M,C,_,R,A;i._RF.push({},"5f903R901JMbJahcI1w/s51","Bonus",void 0);var O=s.ccclass,P=s.property,F=new l(30,30,140,140);e("Bonus",(E=O("Bonus"),L=P({min:0,max:10}),M=P(c),E((R=n((_=function(e){function n(){for(var n,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return n=e.call.apply(e,[this].concat(r))||this,o(n,"rate",R,a(n)),o(n,"bonusPrefab",A,a(n)),n.boundsMap=new Map,n.appendChild=function(e){e.setParent(n.node)},n.removeChild=function(e){n.boundsMap.delete(e),e.removeFromParent()},n}t(n,e);var i=n.prototype;return i.start=function(){console.log("Bonus 启动",this.node.name)},i.onDestroy=function(){console.log("Bonus 销毁")},i.createBonus=function(){var e=u.randomRange(0,10);if(console.log("随机率",e),e>=10-this.rate){console.log("生成一个奖励道具");var n=u.randomRange(F.xMin,F.xMax),t=u.randomRange(F.yMin,F.yMax),o=u.randomRangeInt(b.BASE_IRON,b.LIFE+1),a=d(this.bonusPrefab);a.getComponent(p).spriteFrame=this.game.getBonusTexture(o),a.getComponent(B).data=o,a.setPosition(n,t),this.bindCollider(a.getComponent(h)),this.scheduleOnce(this.appendChild.bind(this,a)),this.boundsMap.set(a,m.now())}},i.bindCollider=function(e){var n=this;e.on(f.BEGIN_CONTACT,(function t(o,a){var r=a.node.getComponent(y).playerType,i=o.node.getComponent(B).data;n.handleBonusEvent(r,i),e.off(f.BEGIN_CONTACT,t),n.scheduleOnce(n.removeChild.bind(n,o.node))}))},i.handleBonusEvent=function(e,n){switch(console.log("处理事件",e,n),n){case b.LIFE:this.game.directlyAddLife(e,1);break;case b.BOMB_ALL:this.game.node.emit(g.EventType.BOMB_ALL_ENEMY);break;case b.FROZEN_ALL:this.game.node.emit(g.EventType.FROZEN_ALL_ENEMY);break;case b.BASE_IRON:this.game.node.emit(g.EventType.IRON_BASE_WALL);break;case b.POWERFUL:this.game.node.emit(g.EventType.PLAYER_POWERFUL,e)}},i.update=function(e){for(var n,t=r(this.boundsMap);!(n=t()).done;){var o=n.value,a=o[0],i=o[1];m.now()-i>8e3&&(this.boundsMap.delete(a),a.removeFromParent())}},i.removeAll=function(){this.node.removeAllChildren(),this.boundsMap.clear()},n}(v)).prototype,"rate",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 8}}),A=n(_.prototype,"bonusPrefab",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=_))||C));i._RF.pop()}}}));

System.register("chunks:///_virtual/Bullet.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Base.ts"],(function(e){var t,i,n,o,r,s,l,a,c,u,d,p,f,h;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.assertThisInitialized,o=e.initializerDefineProperty,r=e.classPrivateFieldLooseBase,s=e.createClass,l=e.classPrivateFieldLooseKey},function(e){a=e.cclegacy,c=e._decorator,u=e.Rect,d=e.BoxCollider2D,p=e.Contact2DType,f=e.Vec3},function(e){h=e.Base}],execute:function(){var y,b,v,w,P,B,C,O,g,T;a._RF.push({},"c628cD28+dNp6WrxCnF2B6o","Bullet",void 0);var j=c.ccclass,D=c.property,N=new u(-104,-104,208,208);e("Bullet",j("Bullet")((w=l("body"),P=l("cld"),B=l("frozen"),C=l("brokenStone"),O=l("owner"),g=l("onCollider"),T=l("transTo"),v=t((b=function(e){function t(){for(var t,i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return t=e.call.apply(e,[this].concat(s))||this,Object.defineProperty(n(t),T,{value:_}),o(t,"speed",v,n(t)),Object.defineProperty(n(t),w,{writable:!0,value:void 0}),Object.defineProperty(n(t),P,{writable:!0,value:void 0}),Object.defineProperty(n(t),B,{writable:!0,value:!1}),Object.defineProperty(n(t),C,{writable:!0,value:!1}),Object.defineProperty(n(t),O,{writable:!0,value:void 0}),Object.defineProperty(n(t),g,{writable:!0,value:function(e,i,o){r(n(t),B)[B]=!0,t.scheduleOnce((function(){t.node.destroy()}))}}),t}i(t,e);var l=t.prototype;return l.onEnable=function(){r(this,w)[w]=this.node.getChildByName("body"),r(this,P)[P]=this.getComponentInChildren(d),r(this,P)[P].once(p.BEGIN_CONTACT,r(this,g)[g])},l.belongTo=function(e,t){void 0===t&&(t=!1),r(this,O)[O]=e,r(this,C)[C]=t},l.owner=function(){return r(this,O)[O]},l.onDisable=function(){r(this,P)[P].off(p.BEGIN_CONTACT,r(this,g)[g])},l.update=function(e){if(!r(this,B)[B]){var t=r(this,w)[w].position;r(this,w)[w].setPosition(new f(t.x-this.speed*e,t.y,t.z)),N.contains(r(this,T)[T]())||this.node.destroy()}},s(t,[{key:"brokenStone",get:function(){return r(this,C)[C]}}]),t}(h)).prototype,"speed",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),y=b))||y);function _(){return this.node.parent.inverseTransformPoint(new f,r(this,w)[w].worldPosition).toVec2()}a._RF.pop()}}}));

System.register("chunks:///_virtual/Data.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var a,e,n,r,c;return{setters:[function(t){a=t.inheritsLoose,e=t.createClass},function(t){n=t.cclegacy,r=t._decorator,c=t.Component}],execute:function(){var o;n._RF.push({},"f9d6893JIRG2L3m/J0kAN3F","Data",void 0);var s=r.ccclass;r.property,t("Data",s("Data")(o=function(t){function n(){for(var a,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return(a=t.call.apply(t,[this].concat(n))||this)._data=void 0,a}return a(n,t),e(n,[{key:"data",get:function(){return this._data},set:function(t){this._data=t}}]),n}(c))||o);n._RF.pop()}}}));

System.register("chunks:///_virtual/eidtor.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Base.ts","./Block.ts","./GameMgr.ts","./Util.ts","./index.js","./index.mjs_cjs=&original=.js"],(function(e){var t,o,n,r,a,i,l,c,s,f,u,v,g,d,p,h,y,b,P,m,k,w;return{setters:[function(e){t=e.applyDecoratedDescriptor,o=e.inheritsLoose,n=e.assertThisInitialized,r=e.initializerDefineProperty,a=e.classPrivateFieldLooseBase,i=e.classPrivateFieldLooseKey},function(e){l=e.cclegacy,c=e._decorator,s=e.Prefab,f=e.Vec2,u=e.Size,v=e.Sprite,g=e.Node,d=e.instantiate,p=e.UITransform,h=e.find,y=e.NodeEventType},function(e){b=e.Base},function(e){P=e.Block},function(e){m=e.BLOCK,k=e.BlockTexture},null,function(e){w=e.default},null],execute:function(){var B,O,C,M,j,x,E,F;l._RF.push({},"a422aQMCJtOh5OoLkwGtIZr","eidtor",void 0);var L=c.ccclass,N=c.property;e("eidtor",(B=L("eidtor"),O=N(s),B((x=i("nodes"),E=i("align"),F=i("drawPath"),j=t((M=function(e){function t(){for(var t,o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a))||this,Object.defineProperty(n(t),F,{value:A}),Object.defineProperty(n(t),E,{value:_}),r(t,"blockPrefab",j,n(t)),Object.defineProperty(n(t),x,{writable:!0,value:new Map}),t}o(t,e);var i=t.prototype;return i.onEnable=function(){var e=this,t=this.game.getMapDataByLevel(1);console.log("初始化数据");var o=new Map,n=new w.Grid(26,26);this.game.loadAllBlockTexture((function(){for(var r=0;r<26;r++)for(var i=0;i<26;i++){var l=26*r+i,c=e.createBlockAt(t[l],new f(8*i,8*r),new u(8,8),l);a(e,x)[x].set("col="+r+",row="+i,c.getComponent(v)),o.set(c,[r,i]),n.setWalkableAt(r,i,-1!==[m.None,m.Forest].indexOf(t[l]))}for(var s,d,p=new w.Grid(13,13),h=0;h<13;h++)for(var y=0;y<13;y++){var b=2*y,k=2*h,B=[[b,k],[b+1,k],[b,k+1],[b+1,k+1]].every((function(e){var o=26*e[0]+e[1];return-1!==[m.None,m.Forest].indexOf(t[o])}));p.setWalkableAt(h,y,B)}e.node.on(g.EventType.MOUSE_DOWN,(function(t){var n=t.target;if(n){var r=n;if(r.getComponent(P))if(s){if(!d){d=a(e,E)[E](o.get(r)),r.getComponent(v).grayscale=!0,console.log(s,d);var i=(new w.AStarFinder).findPath(s[1],s[0],d[1],d[0],p.clone());if(s=d=null,!i||0===i.length)return console.log("找不到路"),void e.clearPath();a(e,F)[F](i)}}else e.clearPath(),s=a(e,E)[E](o.get(r)),r.getComponent(v).grayscale=!0}}),!1)}))},i.createBlockAt=function(e,t,o,n){var r=o.width,a=o.height,i=d(this.blockPrefab),l=this.game.getBlockTexture(e===m.None?m.River:e);return i.name=k[e===m.None?m.River:e].pic+"_"+n,i.getComponent(v).spriteFrame=l,i.getComponent(p).setContentSize(r,a),i.setPosition(t.subtract2f(104,104).add2f(4,4).toVec3()),i.setParent(h("Canvas/blocks")),i.on(y.MOUSE_DOWN,(function(){console.log("BLOCK:",n)})),i},i.clearPath=function(){a(this,x)[x].forEach((function(e){return e.grayscale=!1}))},t}(b)).prototype,"blockPrefab",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=M))||C));function _(e){var t=e[0],o=e[1];return console.log("small",t,o),[Math.floor(t/2),Math.floor(o/2)]}function A(e){var t=this;console.log("结果",e),null==e||e.forEach((function(e){var o=e[0],n=2*e[1],r=2*o;[[n,r],[n+1,r],[n,r+1],[n+1,r+1]].forEach((function(e){var o=e[0],n=e[1];a(t,x)[x].get("col="+o+",row="+n).grayscale=!0}))}))}l._RF.pop()}}}));

System.register("chunks:///_virtual/EnemiesMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameMgr.ts","./Enemy.ts","./MovieClip.ts","./Bonus.ts"],(function(e){var n,t,i,o,r,s,a,l,u,c,f,d,p,m,b,h,y,v;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.assertThisInitialized,o=e.initializerDefineProperty,r=e.createForOfIteratorHelperLoose,s=e.classPrivateFieldLooseBase,a=e.classPrivateFieldLooseKey},function(e){l=e.cclegacy,u=e._decorator,c=e.Node,f=e.Prefab,d=e.instantiate,p=e.find,m=e.Component},function(e){b=e.GameMgr},function(e){h=e.Enemy},function(e){y=e.MovieClip},function(e){v=e.Bonus}],execute:function(){var C,g,E,P,L,_,z,w,M,O,A,F,H,j,D,W;l._RF.push({},"e3c70wfV/VLcb4s8pHKC8li","EnemiesMgr",void 0);var B=u.ccclass,N=u.property,R=[0,1,2];e("EnemiesMgr",(C=B("EnemiesMgr"),g=N(c),E=N(f),P=N(f),L=N(c),C((F=a("game"),H=a("swaps"),j=a("positions"),D=a("generateOneAtSwap"),W=a("fillEnemy"),w=n((z=function(e){function n(){for(var n,t=arguments.length,a=new Array(t),l=0;l<t;l++)a[l]=arguments[l];return n=e.call.apply(e,[this].concat(a))||this,Object.defineProperty(i(n),W,{value:S}),o(n,"enemiesLayer",w,i(n)),o(n,"enemyPrefab",M,i(n)),o(n,"movieClip",O,i(n)),o(n,"bomblayer",A,i(n)),Object.defineProperty(i(n),F,{writable:!0,value:void 0}),n.bonus=void 0,Object.defineProperty(i(n),H,{writable:!0,value:void 0}),Object.defineProperty(i(n),j,{writable:!0,value:void 0}),n.frozenEnemy=function(){n._frozenHandle(!0),n.scheduleOnce(n._frozenHandle.bind(null,!1),8)},n._frozenHandle=function(e){for(var t,i=r(n.enemiesLayer.children);!(t=i()).done;){t.value.getComponent(h).bonusFrozen=e}},Object.defineProperty(i(n),D,{writable:!0,value:function(e,t,o){s(i(n),F)[F].enemyWaitCount()>0&&(e.active=!0,n.scheduleOnce(n._interCreate.bind(i(n),e,t,o),1))}}),n._interCreate=function(e,t,o){if(s(i(n),F)[F].enemyWaitCount()>0){e.active=!1,s(i(n),F)[F].reduceWaitCount(),s(i(n),F)[F].dump();var r=d(n.enemyPrefab);r.setPosition(t),r.setParent(n.enemiesLayer),r.getComponent(h).setSwapID(o)}else e.active=!1},n.destroyAtPos=function(e,t){var o=d(n.movieClip);o.setParent(n.bomblayer),o.getComponent(y).bindDir("bumb"),o.setWorldPosition(e),n.scheduleOnce((function(){o.destroy()}),.5),s(i(n),F)[F].enemyWaitCount()>0&&(n.bonus.createBonus(),n.scheduleOnce(s(i(n),D)[D].bind(i(n),s(i(n),H)[H][t],s(i(n),j)[j][t],t),2.5))},n}t(n,e);var a=n.prototype;return a.onLoad=function(){s(this,F)[F]=p("ref").getComponent(b),this.bonus=p("Canvas/game/Mask/bonus").getComponent(v),s(this,F)[F].node.on(b.EventType.FROZEN_ALL_ENEMY,this.frozenEnemy)},a.setupSwap=function(e,n){this.unschedule(this._frozenHandle),this.unscheduleAllCallbacks(),this.destroyAll(),s(this,H)[H]=e,s(this,j)[j]=n,s(this,W)[W]()},a.onDisable=function(){s(this,F)[F].node.off(b.EventType.FROZEN_ALL_ENEMY,this.frozenEnemy),this.unschedule(this._frozenHandle),this.unschedule(this._interCreate),this.unschedule(s(this,D)[D]),this.destroyAll()},a.destroyAll=function(){this.bomblayer.removeAllChildren(),this.enemiesLayer.removeAllChildren(),this.bonus.removeAll()},n}(m)).prototype,"enemiesLayer",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=n(z.prototype,"enemyPrefab",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=n(z.prototype,"movieClip",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=n(z.prototype,"bomblayer",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=z))||_));function S(){for(var e=Math.min(s(this,F)[F].enemyWaitCount(),3),n=0;n<e;n++){var t=R.shift();s(this,D)[D](s(this,H)[H][t],s(this,j)[j][t],t),R.push(t)}}l._RF.pop()}}}));

System.register("chunks:///_virtual/Enemy.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Base.ts","./Stick.ts","./Player.ts","./EnemiesMgr.ts","./GameMgr.ts","./game.conf.ts","./Bullet.ts"],(function(e){var t,i,n,o,r,a,s,l,c,d,u,h,f,p,b,m,y,g,P,v,T,E,C,O,w,L,I,N;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.assertThisInitialized,o=e.initializerDefineProperty,r=e.classPrivateFieldLooseBase,a=e.createClass,s=e.classPrivateFieldLooseKey},function(e){l=e.cclegacy,c=e._decorator,d=e.Prefab,u=e.Vec3,h=e.instantiate,f=e.Collider2D,p=e.RigidBody2D,b=e.Contact2DType,m=e.find,y=e.Animation,g=e.Sprite,P=e.math,v=e.Vec2},function(e){T=e.Base},function(e){E=e.TOWARDS},function(e){C=e.FACE_TO},function(e){O=e.EnemiesMgr},function(e){w=e.ContactGroup,L=e.GameMgr},function(e){I=e.TankConfig},function(e){N=e.Bullet}],execute:function(){var R,B,D,_,F,j,A,M,G,S,k,U,H,W,z,V,Y,Z,x,q,J;l._RF.push({},"6c9d4Vu6TRF6JvA3Re50SW9","Enemy",void 0);var K=c.ccclass,Q=c.property,X=(e("Enemy",(R=K("Enemy"),B=Q(d),R((j=s("body"),A=s("walkAnimate"),M=s("frozen"),G=s("mgr"),S=s("swapID"),k=s("cld"),U=s("rgd"),H=s("bullets"),W=s("direct"),z=s("tankConfig"),V=s("lostHealth"),Y=s("idelTime"),Z=s("areaInPreSecond"),x=s("distance"),q=s("bonusFrozen"),J=s("shoot"),F=t((_=function(e){function t(){for(var t,i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return t=e.call.apply(e,[this].concat(a))||this,Object.defineProperty(n(t),j,{writable:!0,value:void 0}),Object.defineProperty(n(t),A,{writable:!0,value:void 0}),Object.defineProperty(n(t),M,{writable:!0,value:!1}),Object.defineProperty(n(t),G,{writable:!0,value:void 0}),Object.defineProperty(n(t),S,{writable:!0,value:void 0}),Object.defineProperty(n(t),k,{writable:!0,value:void 0}),Object.defineProperty(n(t),U,{writable:!0,value:void 0}),o(t,"bulletPrefab",F,n(t)),Object.defineProperty(n(t),H,{writable:!0,value:void 0}),Object.defineProperty(n(t),W,{writable:!0,value:void 0}),t.currentTime=0,Object.defineProperty(n(t),z,{writable:!0,value:void 0}),Object.defineProperty(n(t),V,{writable:!0,value:0}),Object.defineProperty(n(t),Y,{writable:!0,value:0}),Object.defineProperty(n(t),Z,{writable:!0,value:new u}),Object.defineProperty(n(t),x,{writable:!0,value:0}),Object.defineProperty(n(t),q,{writable:!0,value:!1}),Object.defineProperty(n(t),J,{writable:!0,value:function(){t.audio.effectPlay("shoot");var e=h(t.bulletPrefab);e.getComponentInChildren(f).group=w.ENEMY_BULLET,e.getComponentInChildren(p).group=w.ENEMY_BULLET,e.setPosition(t.node.position.clone()),e.setRotationFromEuler(r(n(t),j)[j].eulerAngles),e.setParent(r(n(t),H)[H])}}),t.onColliderHandle=function(e,i,o){i.group===w.BULLET||i.group===w.PLAYER?++r(n(t),V)[V]>=r(n(t),z)[z].life?(r(n(t),k)[k].off(b.BEGIN_CONTACT,t.onColliderHandle),r(n(t),M)[M]=!0,t.audio.effectPlay("tank_bomb"),o.disabled=!0,i.group===w.BULLET?(t.game.addPlayerScore(i.node.parent.getComponent(N).owner(),r(n(t),z)[z].bounds),t.game.enemyDie()):t.game.addWaitCount(),r(n(t),G)[G].destroyAtPos(t.node.worldPosition.clone(),r(n(t),S)[S]),t.scheduleOnce((function(){t.node.destroy()}))):t.audio.effectPlay("enemy",.2):t.turnDifferWay()},t.bombed=function(e){t.game.addPlayerScore(e,r(n(t),z)[z].bounds),t.game.enemyDie(),r(n(t),G)[G].destroyAtPos(t.node.worldPosition.clone(),r(n(t),S)[S]),r(n(t),k)[k].off(b.BEGIN_CONTACT,t.onColliderHandle),t.scheduleOnce((function(){t.node.destroy()}))},t}i(t,e);var s=t.prototype;return s.onLoad=function(){e.prototype.onLoad.call(this),r(this,G)[G]=m("Canvas").getComponent(O),r(this,j)[j]=this.node.getChildByName("body"),r(this,z)[z]=this.randomTankMode();var t=this.game.getTankUi(r(this,z)[z].name),i=this.animation.createAnimation(t);r(this,A)[A]=r(this,j)[j].getComponent(y),r(this,A)[A].defaultClip=i,r(this,j)[j].getComponent(g).spriteFrame=t.sfs[0].clone(),r(this,A)[A].playOnLoad=!0,r(this,k)[k]=this.getComponent(f),r(this,k)[k].on(b.BEGIN_CONTACT,this.onColliderHandle),r(this,U)[U]=this.getComponent(p),r(this,H)[H]=m("Canvas/game/Mask/bullets"),this.game.node.once(L.EventType.BOMB_ALL_ENEMY,this.bombed)},s.getBounds=function(){return r(this,z)[z].bounds},s.randomTankMode=function(){return I[P.randomRangeInt(0,8)]},s.onDisable=function(){r(this,M)[M]=!0,r(this,A)[A].pause(),r(this,k)[k].off(b.BEGIN_CONTACT,this.onColliderHandle),this.game.node.off(L.EventType.BOMB_ALL_ENEMY,this.bombed)},s.turnDifferWay=function(){var e=this;r(this,M)[M]=!0,this.scheduleOnce((function(){var t=[E.UP,E.DOWN,E.DOWN,E.DOWN,E.RIGHT,E.LEFT].filter((function(t){return t!==r(e,W)[W]}));e.toward(t[P.randomRangeInt(0,t.length)]),r(e,M)[M]=!1}),.1)},s.setSwapID=function(e){r(this,S)[S]=e,this.toward(0===e?E.LEFT:E.RIGHT)},s.toward=function(e){switch(r(this,W)[W]=e,e){case E.UP:r(this,j)[j].setRotationFromEuler(u.UNIT_Z.clone().multiplyScalar(C.UP));break;case E.DOWN:r(this,j)[j].setRotationFromEuler(u.UNIT_Z.clone().multiplyScalar(C.DOWN));break;case E.LEFT:r(this,j)[j].setRotationFromEuler(u.UNIT_Z.clone().multiplyScalar(C.LEFT));break;case E.RIGHT:r(this,j)[j].setRotationFromEuler(u.UNIT_Z.clone().multiplyScalar(C.RIGHT))}return this},s.update=function(e){if(r(this,q)[q])r(this,U)[U].linearVelocity=new v;else{if(!r(this,M)[M]){r(this,U)[U].linearVelocity=X(r(this,W)[W]).multiplyScalar(r(this,z)[z].speed*e).toVec2(),this.currentTime+=e;var t=P.clamp(Math.pow(.975,this.game.getGameLevel()-1),.4,1);r(this,z)[z].attack&&this.currentTime>=r(this,z)[z].shootGap*t&&(this.currentTime=0,r(this,J)[J]())}r(this,Z)[Z].equals(u.ZERO)?this.node.getWorldPosition(r(this,Z)[Z]):(r(this,Y)[Y]+=e,r(this,Y)[Y]>2?(r(this,Y)[Y]=0,r(this,x)[x]>8?r(this,x)[x]=0:this.turnDifferWay()):(u.subtract(r(this,Z)[Z],this.node.worldPosition,r(this,Z)[Z]),r(this,x)[x]+=Math.abs(r(this,Z)[Z].x)+Math.abs(r(this,Z)[Z].y),this.node.getWorldPosition(r(this,Z)[Z])))}},a(t,[{key:"bonusFrozen",set:function(e){r(this,q)[q]=e}}]),t}(T)).prototype,"bulletPrefab",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=_))||D)),function(e){var t;return(t={},t[E.UP]=u.UP.clone(),t[E.RIGHT]=u.RIGHT.clone(),t[E.LEFT]=u.RIGHT.clone().multiplyScalar(-1),t[E.DOWN]=u.UP.clone().multiplyScalar(-1),t)[e]});l._RF.pop()}}}));

System.register("chunks:///_virtual/Fight.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Base.ts","./GameMgr.ts","./Block.ts","./Player.ts","./MovieClip.ts","./EnemiesMgr.ts","./Stick.ts","./game.conf.ts"],(function(e){var t,i,n,a,r,o,l,s,c,h,p,u,b,d,m,y,g,f,v,P,w,C,L,T,E,k,A,S,_,B,M,O,I,U,G;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.assertThisInitialized,a=e.initializerDefineProperty,r=e.classPrivateFieldLooseBase,o=e.classPrivateFieldLooseKey,l=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){c=e.cclegacy,h=e._decorator,p=e.Size,u=e.Vec2,b=e.Vec3,d=e.Node,m=e.Prefab,y=e.Label,g=e.director,f=e.instantiate,v=e.find,P=e.Camera,w=e.sys,C=e.Sprite,L=e.UITransform},function(e){T=e.Base},function(e){E=e.GameMode,k=e.PlayerType,A=e.GameMgr,S=e.BlockTexture,_=e.BLOCK},function(e){B=e.Block},function(e){M=e.Player},function(e){O=e.MovieClip},function(e){I=e.EnemiesMgr},function(e){U=e.Stick},function(e){G=e.TOTAL_LEVELS}],execute:function(){var x,z,R,F,N,D,V,Y,j,W,H,K,X,Z,q,J,Q,$,ee,te,ie,ne,ae,re,oe,le,se,ce,he,pe,ue,be,de;c._RF.push({},"98c8crXdH1NI5Zlotk19zeC","Fight",void 0);var me=h.ccclass,ye=h.property,ge=new p(208,208),fe=new p(8,8),ve=new u(ge.width,ge.height).multiplyScalar(.5),Pe=e("SWAPN_POINTS",[(new b).add3f(-ge.x/2+fe.width,ge.height/2-fe.height,0),(new b).add3f(0,ge.height/2-fe.height,0),(new b).add3f(ge.x/2-fe.width,ge.height/2-fe.height,0)]),we=new u(666,659);e("Fight",(x=me("Fight"),z=ye({type:d,displayName:"下层"}),R=ye({type:d,displayName:"上层"}),F=ye(m),N=ye({type:d,displayName:"玩家容器"}),D=ye(m),V=ye({displayName:"出生无敌时间"}),Y=ye(m),j=ye(d),W=ye(y),H=ye(d),K=ye(d),x((le=o("mainCamera"),se=o("deputyCamera"),ce=o("player2Camera"),he=o("level"),pe=o("playerSticks"),ue=o("removeAll"),be=o("createEnemySwapPoint"),de=o("disConnectStick"),q=t((Z=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return t=e.call.apply(e,[this].concat(o))||this,Object.defineProperty(n(t),de,{value:Te}),Object.defineProperty(n(t),be,{value:Le}),Object.defineProperty(n(t),ue,{value:Ce}),Object.defineProperty(n(t),le,{writable:!0,value:void 0}),Object.defineProperty(n(t),se,{writable:!0,value:void 0}),Object.defineProperty(n(t),ce,{writable:!0,value:void 0}),Object.defineProperty(n(t),he,{writable:!0,value:1}),a(t,"behind",q,n(t)),a(t,"front",J,n(t)),a(t,"blockPrefab",Q,n(t)),a(t,"players",$,n(t)),a(t,"playerPrefab",ee,n(t)),a(t,"invincibleTime",te,n(t)),Object.defineProperty(n(t),pe,{writable:!0,value:new Map}),a(t,"movieClip",ie,n(t)),a(t,"bomblayer",ne,n(t)),a(t,"stageLabel",ae,n(t)),a(t,"levelUI",re,n(t)),a(t,"enemies",oe,n(t)),t.powerFullUp=function(e){t.players.getChildByName("player_"+e).getComponent(M).upPlayerLevel()},t.baseChangeToStone=function(){[661,635,609,610,611,612,638,664].forEach((function(e){var i=t.behind.getChildByName("wall_"+e);i&&i.getComponent(B).stonezile()}))},t.nextLevel=function(){t.audio.stopAll(),r(n(t),he)[he]>=G?g.loadScene("win"):(r(n(t),he)[he]++,r(n(t),ue)[ue](),t.createGameMap())},t.destroyAtPos=function(e,i){void 0===i&&(i=0);var n=f(t.movieClip);n.setParent(t.bomblayer),n.getComponent(O).bindDir("blast"),n.setWorldPosition(e),t.scheduleOnce((function(){n.destroy()}),.5),t.createPlayerById(i)},t.createPlayerById=function(e){t.scheduleOnce((function(){var i=t.blockIndexToPos(0!==e&&t.game.getMode()===E.DOUBLE?we.y:we.x),a=f(t.playerPrefab);a.name="player_"+e,a.setPosition(i.toVec3().subtract(new b(0,4,0))),a.setParent(t.players);var o=v("Canvas/ui/sticks/player"+(0!==e&&t.game.getMode()===E.DOUBLE?"2":"1")),l=a.getComponent(M);o.getComponent(U).hidenVirUI().setUserType(e),l.bindStick(o,e),l.invincible(t.invincibleTime),l.initGlobalLevel(t.game.getGlobalPlayerLevel(e)),l.playerType=0!==e&&t.game.getMode()===E.DOUBLE?k.PLAYER_2:k.PLAYER_1,r(n(t),pe)[pe].set(l,o)}),1)},t}i(t,e);var o=t.prototype;return o.onLoad=function(){e.prototype.onLoad.call(this);var t=this.getComponentsInChildren(P);r(this,le)[le]=t[0],r(this,se)[se]=t[1],r(this,ce)[ce]=t[2],r(this,le)[le].orthoHeight=104},o.onEnable=function(){var e=this;console.log("开启模式:",this.game.getMode()),this.setupCamare(),this.game.loadAllBlockTexture((function(){e.createGameMap()})),this.game.node.on(A.EventType.NEXT_STAGE,this.nextLevel),this.game.node.on(A.EventType.IRON_BASE_WALL,this.baseChangeToStone),this.game.node.on(A.EventType.PLAYER_POWERFUL,this.powerFullUp)},o.onDisable=function(){console.log("FIGHT DISABLE"),this.game.node.off(A.EventType.NEXT_STAGE,this.nextLevel),this.game.node.off(A.EventType.IRON_BASE_WALL,this.baseChangeToStone),this.game.node.off(A.EventType.PLAYER_POWERFUL,this.powerFullUp),r(this,de)[de](),this.unscheduleAllCallbacks()},o.setupCamare=function(){if(w.isMobile)switch(this.game.getMode()){case E.DOUBLE:r(this,se)[se].enabled=!0,r(this,ce)[ce].enabled=!0,r(this,le)[le].enabled=!1;break;default:r(this,le)[le].enabled=!0,r(this,se)[se].enabled=r(this,ce)[ce].enabled=!1}else r(this,le)[le].enabled=!0,r(this,se)[se].enabled=r(this,ce)[ce].enabled=!1},o.prevLevel=function(){r(this,he)[he]--,r(this,ue)[ue](),this.createGameMap()},o.createGameMap=function(){var e=l(s().mark((function e(){var t,i,n,a,o=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.audio.effectPlay("game_start"),this.levelUI.active=!0,this.stageLabel.string=r(this,he)[he]+"",this.game.setGameLevel(r(this,he)[he]),v("Canvas/ui").active=!1,e.next=7,new Promise((function(e){o.scheduleOnce(e,3)}));case 7:for(this.levelUI.active=!1,v("Canvas/ui").active=!0,t=this.game.getMapDataByLevel(r(this,he)[he]),i=0;i<t.length;i++)t[i]!==_.None?(n=Math.floor(i/26),a=new u((i%26+.5)*fe.width,(n+.5)*fe.height).subtract(ve).multiplyScalar(-1),this.createBlockAt(t[i],a,fe,i)):13===i&&this.createBlockAt(_.Camp,new u(0,fe.height-.5*ge.height),new p(2*fe.width,2*fe.height),i);this.createPlayerTank(),r(this,be)[be]();case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.createBlockAt=function(e,t,i,n){var a=i.width,r=i.height,o=f(this.blockPrefab),l=this.game.getBlockTexture(e);return o.name=S[e].pic+"_"+n,o.getComponent(C).spriteFrame=l,o.getComponent(L).setContentSize(a,r),o.setPosition(t.toVec3()),e===_.Forest?o.setParent(this.front):o.setParent(this.behind),o.getComponent(B).setBlockType(e),o},o.blockIndexToPos=function(e){var t=Math.floor(e/26);return new u((e%26+.5)*fe.width,(t+.5)*fe.height).subtract(ve).multiplyScalar(-1)},o.createPlayerTank=function(){r(this,de)[de]();var e=this.blockIndexToPos(we.x),t=f(this.playerPrefab);t.name="player_0",t.setPosition(e.toVec3().subtract(new b(0,4,0))),t.setParent(this.players);var i=v("Canvas/ui/sticks/player1");i.getComponent(U).hidenVirUI(this.game.getMode()===E.DOUBLE?-90:0).setUserType(k.PLAYER_1);var n=t.getComponent(M);if(n.bindStick(i,0),n.invincible(this.invincibleTime),n.initGlobalLevel(this.game.getGlobalPlayerLevel(k.PLAYER_1)),n.playerType=k.PLAYER_1,r(this,pe)[pe].set(n,i),this.game.getMode()===E.DOUBLE){var a=this.blockIndexToPos(we.y),o=f(this.playerPrefab);o.name="player_1",o.setPosition(a.toVec3().subtract(new b(0,4,0))),o.setParent(this.players);var l=v("Canvas/ui/sticks/player2");l.active=!0,l.getComponent(U).hidenVirUI(90).setUserType(k.PLAYER_2);var s=o.getComponent(M);s.bindStick(l,1),s.invincible(this.invincibleTime),s.initGlobalLevel(this.game.getGlobalPlayerLevel(k.PLAYER_2)),s.playerType=k.PLAYER_2,r(this,pe)[pe].set(s,l),console.log("玩家name:",t.name,o.name)}},t}(T)).prototype,"behind",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J=t(Z.prototype,"front",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q=t(Z.prototype,"blockPrefab",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=t(Z.prototype,"players",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee=t(Z.prototype,"playerPrefab",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),te=t(Z.prototype,"invincibleTime",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),ie=t(Z.prototype,"movieClip",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ne=t(Z.prototype,"bomblayer",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ae=t(Z.prototype,"stageLabel",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),re=t(Z.prototype,"levelUI",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oe=t(Z.prototype,"enemies",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X=Z))||X));function Ce(){this.front.removeAllChildren(),this.behind.removeAllChildren(),this.players.removeAllChildren(),this.enemies.removeAllChildren()}function Le(){var e=this,t=v("Canvas/game/Mask/swap_point");t.removeAllChildren();var i=Pe.map((function(i){var n=f(e.movieClip).getComponent(O);return n.node.setPosition(i),n.node.setParent(t),n.node.setScale(.8,.8),n.bindDir("star"),n.node.active=!1,n.node}));this.getComponent(I).setupSwap(i,Pe)}function Te(){console.log("销毁STICK 关联"),r(this,pe)[pe].forEach((function(e,t){t.unBindStick()})),r(this,pe)[pe].clear()}c._RF.pop()}}}));

System.register("chunks:///_virtual/game.conf.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var n,_;return{setters:[function(e){n=e.extends},function(e){_=e.cclegacy}],execute:function(){var a;_._RF.push({},"32170ZfztdPZKyUDk9lmh4o","game.conf",void 0);var t={name:"tank_green_1",speed:50,life:1,attack:!0,shootGap:2.5,bounds:225},o=(e("TankConfig",[n({},t,{life:3,shootGap:1,bounds:654}),n({},t,{name:"tank_red_1"}),n({},t,{name:"tank_red_2",speed:90,shootGap:1,bounds:654}),n({},t,{name:"tank_red_3"}),n({},t,{name:"tank_red_4",life:3,bounds:539}),n({},t,{name:"tank_white_1"}),n({},t,{name:"tank_white_2",speed:90,shootGap:1,bounds:654}),n({},t,{name:"tank_white_3",life:3,bounds:539}),n({},t,{name:"tank_yellow_1",life:1}),n({},t,{name:"tank_yellow_2",life:2}),n({},t,{name:"tank_yellow_3",life:3}),n({},t,{name:"tank_yellow_4",life:4}),n({},t,{name:"tank_yellow_5",life:5})]),e("ENEMY_TOTAL_PER_LEVEL",13),e("PLAYER_LIFE_TOTAL",8),e("TOTAL_LEVELS",36),e("LIFE_AWARD_GAP",5500),e("BASE_BLOCK",[661,635,609,610,611,612,638,664]),e("PLAYER_LEVEL",function(e){return e[e.ONE=0]="ONE",e[e.TWO=1]="TWO",e[e.THREE=2]="THREE",e[e.FOUR=3]="FOUR",e[e.FIVE=4]="FIVE",e}({})));e("PLAYER_CONFIG",((a={})[o.ONE]="tank_yellow_1",a[o.TWO]="tank_yellow_2",a[o.THREE]="tank_yellow_3",a[o.FOUR]="tank_yellow_4",a[o.FIVE]="tank_yellow_5",a));_._RF.pop()}}}));

System.register("chunks:///_virtual/GameMgr.ts",["./rollupPluginModLoBabelHelpers.js","cc","./game.conf.ts","./AudioMgr.ts","./toast.ts"],(function(e){var t,n,i,o,a,r,l,c,E,s,u,L,f,d,p,_,A,m,y,R,v,P,h,O,g;return{setters:[function(e){t=e.inheritsLoose,n=e.assertThisInitialized,i=e.classPrivateFieldLooseBase,o=e.createClass,a=e.classPrivateFieldLooseKey},function(e){r=e.cclegacy,l=e._decorator,c=e.KeyCode,E=e.game,s=e.sys,u=e.input,L=e.Input,f=e.math,d=e.find,p=e.resources,_=e.TextAsset,A=e.SpriteFrame,m=e.director,y=e.Component},function(e){R=e.ENEMY_TOTAL_PER_LEVEL,v=e.PLAYER_LEVEL,P=e.PLAYER_LIFE_TOTAL,h=e.LIFE_AWARD_GAP},function(e){O=e.AudioMgr},function(e){g=e.toast}],execute:function(){var T,b,B,M,Y,S,N,D,F,C,w,G,I,U,k,j,K;r._RF.push({},"bd860eBKURBBLuDdELTkQl7","GameMgr",void 0);var W=l.ccclass,x=(l.property,e("GameMode",function(e){return e[e.SINGLE=0]="SINGLE",e[e.DOUBLE=1]="DOUBLE",e}({}))),V=e("BLOCK",function(e){return e.None="0",e.Forest="1",e.Ice="2",e.Wall="3",e.River="4",e.Stone="5",e.Camp="99",e.Camp_BROKEN="100",e}({})),z=e("BONUS",function(e){return e[e.BASE_IRON=0]="BASE_IRON",e[e.BOMB_ALL=1]="BOMB_ALL",e[e.FROZEN_ALL=2]="FROZEN_ALL",e[e.POWERFUL=3]="POWERFUL",e[e.LIFE=4]="LIFE",e}({})),Z=e("BonusTexture",((T={})[z.BASE_IRON]="base-iron",T[z.BOMB_ALL]="bomb-all",T[z.FROZEN_ALL]="frozen-all",T[z.POWERFUL]="strong-power",T[z.LIFE]="tank-life",T)),H=(e("ContactGroup",function(e){return e[e.DEFAULT=1]="DEFAULT",e[e.PLAYER=2]="PLAYER",e[e.BULLET=4]="BULLET",e[e.BLOCK=8]="BLOCK",e[e.FOREST=16]="FOREST",e[e.RIVER=32]="RIVER",e[e.ENEMY=64]="ENEMY",e[e.ENEMY_BULLET=128]="ENEMY_BULLET",e[e.BONUS=256]="BONUS",e}({})),e("BlockTexture",((b={})[V.Forest]={pic:"forest"},b[V.Ice]={pic:"ice"},b[V.Wall]={pic:"wall"},b[V.River]={pic:"river-0"},b[V.Stone]={pic:"stone"},b[V.Camp]={pic:"camp0"},b[V.Camp_BROKEN]={pic:"camp1"},b))),X=e("PlayerType",function(e){return e[e.PLAYER_1=0]="PLAYER_1",e[e.PLAYER_2=1]="PLAYER_2",e}({}));e("GameMgr",W("GameMgr")((Y=a("mode"),S=a("map"),N=a("tankMap"),D=a("blockMap"),F=a("_ready"),C=a("sfsMap"),w=a("itemMap"),G=a("playerinfo"),I=a("player2info"),U=a("enemy_wait_create_cnt"),k=a("enemy_die_count"),j=a("game_level"),K=a("quit"),(M=function(e){function a(){for(var t,o=arguments.length,r=new Array(o),l=0;l<o;l++)r[l]=arguments[l];return t=e.call.apply(e,[this].concat(r))||this,Object.defineProperty(n(t),Y,{writable:!0,value:x.SINGLE}),Object.defineProperty(n(t),S,{writable:!0,value:new Map}),Object.defineProperty(n(t),N,{writable:!0,value:new Map}),Object.defineProperty(n(t),D,{writable:!0,value:new Map}),Object.defineProperty(n(t),F,{writable:!0,value:!1}),Object.defineProperty(n(t),C,{writable:!0,value:new Map}),Object.defineProperty(n(t),w,{writable:!0,value:new Map}),Object.defineProperty(n(t),G,{writable:!0,value:void 0}),Object.defineProperty(n(t),I,{writable:!0,value:void 0}),Object.defineProperty(n(t),U,{writable:!0,value:void 0}),Object.defineProperty(n(t),k,{writable:!0,value:0}),Object.defineProperty(n(t),j,{writable:!0,value:1}),t.setGameLevel=function(e){i(n(t),j)[j]=e,t.node.emit(a.EventType.GAME_LEVEL_CHANGE,e)},t.discountLife=function(e){e===X.PLAYER_1?(i(n(t),G)[G].life=i(n(t),G)[G].life-1,t.node.emit(a.EventType.PLAYER_LIFE_LOST,e)):(i(n(t),I)[I].life=i(n(t),I)[I].life-1,t.node.emit(a.EventType.PLAYER_LIFE_LOST,e)),(i(n(t),Y)[Y]===x.SINGLE&&0===i(n(t),G)[G].life||0===i(n(t),G)[G].life&&0===i(n(t),I)[I].life)&&t.gameOver()},t.addPlayerScore=function(e,o){e===X.PLAYER_1?(i(n(t),G)[G].score+=o,t.checkAddLife(i(n(t),G)[G],o),t.node.emit(a.EventType.PLAYER_SCORE_ADD,{id:X.PLAYER_1,score:o})):(i(n(t),I)[I].score+=o,t.checkAddLife(i(n(t),I)[I],o),t.node.emit(a.EventType.PLAYER_SCORE_ADD,{id:X.PLAYER_2,score:o}))},t.enemyDie=function(){i(n(t),k)[k]++,t.node.emit(a.EventType.ENEMY_DISCOUNT),i(n(t),k)[k]>=R&&(console.log("你赢了"),t.scheduleOnce((function(){console.log("下一关"),i(n(t),k)[k]=0,i(n(t),U)[U]=R,t.node.emit(a.EventType.NEXT_STAGE)}),1))},Object.defineProperty(n(t),K,{writable:!0,value:function(e){e.keyCode!==c.BACKSPACE&&e.keyCode!==c.MOBILE_BACK||E.end()}}),t}t(a,e);var r=a.prototype;return r.getGlobalPlayerLevel=function(e){return e===X.PLAYER_1?i(this,G)[G].level:i(this,I)[I].level},r.getGameLevel=function(){return i(this,j)[j]},r.asyncPlayerLevel=function(e,t){e===X.PLAYER_1?i(this,G)[G].level=t:i(this,I)[I].level=t},r.onEnable=function(){this.resetGameinfo(),s.isMobile&&u.on(L.EventType.KEY_UP,i(this,K)[K])},r.onDisable=function(){s.isMobile&&u.off(L.EventType.KEY_UP,i(this,K)[K])},r.dump=function(){console.log("当前还未生成数量:",i(this,U)[U],"已经死掉的：",i(this,k)[k])},r.reduceWaitCount=function(e){void 0===e&&(e=1),i(this,U)[U]=f.clamp(i(this,U)[U]-e,0,R)},r.enemyWaitCount=function(){return i(this,U)[U]},r.addWaitCount=function(){i(this,U)[U]+=1},r.resetGameinfo=function(){i(this,G)[G]={id:X.PLAYER_1,level:v.ONE,life:P,score:0,awardGap:h},i(this,I)[I]={id:X.PLAYER_2,level:v.ONE,life:P,score:0,awardGap:h},i(this,U)[U]=R,i(this,k)[k]=0,this.node.emit(a.EventType.RESET_ALL)},r.checkAddLife=function(e,t){e.awardGap-t<0?(e.life++,e.awardGap=h-(t-e.awardGap),d("ref").getComponent(O).effectPlay("get_double_laser"),this.node.emit(a.EventType.PLAYER_LIFE_ADD,e.id)):e.awardGap-=t},r.directlyAddLife=function(e,t){void 0===t&&(t=1),e===X.PLAYER_1?i(this,G)[G].life+=t:i(this,I)[I].life+=t,d("ref").getComponent(O).effectPlay("get_double_laser"),this.node.emit(a.EventType.PLAYER_LIFE_ADD,e)},r.onLoad=function(){var e=this;p.loadDir("mapsdata/",_,(function(t,n){t?g(t.message):(n.forEach((function(t){i(e,S)[S].set(t.name,t.text)})),console.log("地图数据加载完了"),e.node.emit("mapDataReady"),p.loadDir("tank/",A,(function(t,n){t?g(t.message):(n.forEach((function(t){var n;t.addRef();var o=t.name.replace(/_\d$/gi,""),a=null!=(n=i(e,N)[N].get(o))?n:[];a.push(t),i(e,N)[N].set(o,a)})),i(e,F)[F]=!0,console.log("坦克皮肤加载完了"),e.node.emit("tankUiReady"),p.loadDir("/items",A,(function(t,n){t?g(t.message):(n.forEach((function(t){t.addRef(),i(e,w)[w].set(t.name,t)})),console.log("道具皮肤加载完了"),e.node.emit("itemReady"),e.node.emit("ready"))})))})))}))},r.getBonusTexture=function(e){return i(this,w)[w].get(Z[e])},r.loadSpriteFrameDir=function(e,t){var n=this;if(!i(this,C)[C].has(e)){var o=!1;return p.loadDir(e,A,(function(a,r){a||(r.forEach((function(e){e.addRef()})),i(n,C)[C].set(e,r),o||t(r))})),function(){o=!0}}t(i(this,C)[C].get(e))},r.getMapDataByLevel=function(e){return i(this,S)[S].get(e.toString())},r.loadAllBlockTexture=function(e){var t=this;0===i(this,D)[D].size?p.loadDir("map/",A,(function(n,o){n||(o.forEach((function(e){e.addRef(),i(t,D)[D].set(e.name,e)})),e())})):e()},r.getBlockTexture=function(e){return i(this,D)[D].get(H[e].pic)},r.getTankUi=function(e){return{name:e,sfs:i(this,N)[N].get(e)}},r.setMode=function(e){i(this,Y)[Y]=e},r.getMode=function(){return i(this,Y)[Y]},r.gameOver=function(){this.node.emit(a.EventType.RESET_ALL),m.loadScene("over")},o(a,[{key:"ready",get:function(){return i(this,F)[F]}}]),a}(y)).EventType={RESET_ALL:"resetAll",PLAYER_SCORE_ADD:"playerScoreAdd",PLAYER_LIFE_LOST:"playerLifeLost",PLAYER_LIFE_ADD:"playerLifeAdd",ENEMY_DISCOUNT:"enemyDisCount",GAME_LEVEL_CHANGE:"gameLevelChange",NEXT_STAGE:"nextStage",BOMB_ALL_ENEMY:"bombAllEnemy",IRON_BASE_WALL:"ironBaseWall",FROZEN_ALL_ENEMY:"frozenAllEnemy",PLAYER_POWERFUL:"playerPowerful"},B=M))||B);r._RF.pop()}}}));

System.register("chunks:///_virtual/joyket.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(o){var n,t,e,c,i,u,r,s;return{setters:[function(o){n=o.inheritsLoose},function(o){t=o.cclegacy,e=o._decorator,c=o.input,i=o.Input,u=o.misc,r=o.Vec2,s=o.Component}],execute:function(){var a;t._RF.push({},"0907dvmWq9JOJCt6yIn5lAa","joyket",void 0);var l=e.ccclass;e.property,o("joyket",l("joyket")(a=function(o){function t(){for(var n,t=arguments.length,e=new Array(t),c=0;c<t;c++)e[c]=arguments[c];return(n=o.call.apply(o,[this].concat(e))||this).isTouching=!1,n.onTouchStart=function(o){n.isTouching=!0},n.onTouchMove=function(o){if(n.isTouching){var t=o.touch.getLocation().subtract(o.getStartLocation()).normalize(),e=(t.y>0?1:-1)*u.radiansToDegrees(t.angle(r.UNIT_X));console.log(e),e>-135&&e<=-45?console.log("下"):e>-45&&e<=45?console.log("右"):e>45&&e<=135?console.log("上"):console.log("左")}},n.onTouchEnd=function(o){n.isTouching=!1},n}return n(t,o),t.prototype.onEnable=function(){c.on(i.EventType.TOUCH_START,this.onTouchStart),c.on(i.EventType.TOUCH_MOVE,this.onTouchMove),c.on(i.EventType.TOUCH_END,this.onTouchEnd),c.on(i.EventType.TOUCH_CANCEL,this.onTouchEnd)},t}(s))||a);t._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./app.ts","./Base.ts","./Data.ts","./MovieClip.ts","./Util.ts","./eidtor.ts","./joyket.ts","./Block.ts","./Bonus.ts","./Bullet.ts","./Enemy.ts","./Fight.ts","./Player.ts","./Stick.ts","./ui-controler.ts","./game.conf.ts","./Menu.ts","./AnimationMgr.ts","./AudioMgr.ts","./EnemiesMgr.ts","./GameMgr.ts","./toast.ts","./Over.ts","./Win.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/Menu.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Base.ts"],(function(e){var t,i,n,r,o,s,c,a,u,l;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,s=e._decorator,c=e.Node,a=e.ToggleContainer,u=e.director},function(e){l=e.Base}],execute:function(){var p,h,f,d,g;o._RF.push({},"33233c0JeNAhJ0bhHEYLp7d","Menu",void 0);var v=s.ccclass,y=s.property;e("Menu",(p=v("Menu"),h=y(c),p((g=t((d=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return t=e.call.apply(e,[this].concat(o))||this,n(t,"tips",g,r(t)),t}i(t,e);var o=t.prototype;return o.gotoGame=function(){var e=this.getComponentInChildren(a).toggleItems.findIndex((function(e){return e.isChecked}));this.game.setMode(e),u.loadScene("fight")},o.showTips=function(){this.tips.active=!0},o.hideTips=function(){this.tips.active=!1},t}(l)).prototype,"tips",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=d))||f));o._RF.pop()}}}));

System.register("chunks:///_virtual/MovieClip.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Base.ts"],(function(i){var t,e,n,r,a,o,l,s,p,u;return{setters:[function(i){t=i.applyDecoratedDescriptor,e=i.inheritsLoose,n=i.initializerDefineProperty,r=i.assertThisInitialized},function(i){a=i.cclegacy,o=i._decorator,l=i.Animation,s=i.Sprite,p=i.AnimationClip},function(i){u=i.Base}],execute:function(){var c,h,d,m,f,v,y;a._RF.push({},"425b6VH99RMv5iz3/jO7Jwt","MovieClip",void 0);var b=o.ccclass,g=o.property;i("MovieClip",(c=b("MovieClip"),h=g({displayName:"动画文件夹"}),d=g({displayName:"每帧时间"}),c((v=t((f=function(i){function t(){for(var t,e=arguments.length,a=new Array(e),o=0;o<e;o++)a[o]=arguments[o];return t=i.call.apply(i,[this].concat(a))||this,n(t,"dirPath",v,r(t)),n(t,"durationPerFrame",y,r(t)),t.handle=void 0,t}e(t,i);var a=t.prototype;return a.start=function(){""!=this.dirPath&&this.bindDir(this.dirPath,this.durationPerFrame)},a.bindDir=function(i,t){var e=this;void 0===t&&(t=.1),this.node.parent?(this.dirPath=i,this.handle=this.game.loadSpriteFrameDir(this.dirPath,(function(i){try{var n=e.getComponent(l);n||(n=e.addComponent(l)),e.getComponent(s).spriteFrame=i[0],n.playOnLoad=!0;var r=e.animation.createAnimation({sfs:i,name:e.dirPath,gap:t,mode:p.WrapMode.Loop});n.defaultClip=r}catch(i){}}))):console.warn("未添加到显示列表动画无法播放",i)},a.onEnable=function(){var i;null==(i=this.getComponent(l))||i.resume()},a.onDisable=function(){var i;null==(i=this.getComponent(l))||i.pause(),this.handle&&(this.handle(),this.handle=null)},t}(u)).prototype,"dirPath",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),y=t(f.prototype,"durationPerFrame",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),m=f))||m));a._RF.pop()}}}));

System.register("chunks:///_virtual/Over.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Base.ts"],(function(e){var t,o,r,n,c;return{setters:[function(e){t=e.inheritsLoose},function(e){o=e.cclegacy,r=e._decorator,n=e.director},function(e){c=e.Base}],execute:function(){var i;o._RF.push({},"30f72OIv5xEc4tUi7jYjY27","Over",void 0);var s=r.ccclass;r.property,e("Over",s("Over")(i=function(e){function o(){return e.apply(this,arguments)||this}t(o,e);var r=o.prototype;return r.start=function(){this.audio.stopAll(),console.log("over: ref",this.audio.count++),this.audio.effectPlay("game_over")},r.gotoMenu=function(){n.loadScene("menu")},o}(c))||i);o._RF.pop()}}}));

System.register("chunks:///_virtual/Player.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Base.ts","./Stick.ts","./GameMgr.ts","./Fight.ts","./Bullet.ts","./game.conf.ts"],(function(e){var t,i,n,o,a,l,r,s,c,u,h,p,d,f,y,v,b,P,T,m,O,g,E,C,N,w,F,L;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.assertThisInitialized,o=e.initializerDefineProperty,a=e.classPrivateFieldLooseBase,l=e.createClass,r=e.classPrivateFieldLooseKey},function(e){s=e.cclegacy,c=e._decorator,u=e.Prefab,h=e.Vec2,p=e.Vec3,d=e.instantiate,f=e.RigidBody2D,y=e.Animation,v=e.find,b=e.Collider2D,P=e.Contact2DType,T=e.math,m=e.Sprite},function(e){O=e.Base},function(e){g=e.TOWARDS,E=e.Stick},function(e){C=e.ContactGroup},function(e){N=e.Fight},function(e){w=e.Bullet},function(e){F=e.PLAYER_LEVEL,L=e.PLAYER_CONFIG}],execute:function(){var k,D,I,S,B,R,_,j,G,H,U,A,W,x,Z,z,M,V,Y,K;s._RF.push({},"4ae23vdGpNDhZTF2Q2e7SZw","Player",void 0);var Q=c.ccclass,q=c.property,J=e("FACE_TO",function(e){return e[e.UP=-90]="UP",e[e.DOWN=90]="DOWN",e[e.RIGHT=180]="RIGHT",e[e.LEFT=0]="LEFT",e}({}));e("Player",(k=Q("Player"),D=q(u),k((_=r("animation"),j=r("direction"),G=r("rgd"),H=r("body"),U=r("stick"),A=r("playerID"),W=r("bullets"),x=r("shootTime"),Z=r("currentTime"),z=r("frozen"),M=r("invincibling"),V=r("stickHandle"),Y=r("playWhenWalk"),K=r("shoot"),B=t((S=function(e){function t(){for(var t,i=arguments.length,l=new Array(i),r=0;r<i;r++)l[r]=arguments[r];return t=e.call.apply(e,[this].concat(l))||this,Object.defineProperty(n(t),Y,{value:X}),Object.defineProperty(n(t),_,{writable:!0,value:void 0}),o(t,"speed",B,n(t)),Object.defineProperty(n(t),j,{writable:!0,value:new h}),Object.defineProperty(n(t),G,{writable:!0,value:void 0}),Object.defineProperty(n(t),H,{writable:!0,value:void 0}),o(t,"bulletPrefab",R,n(t)),Object.defineProperty(n(t),U,{writable:!0,value:void 0}),Object.defineProperty(n(t),A,{writable:!0,value:void 0}),Object.defineProperty(n(t),W,{writable:!0,value:void 0}),Object.defineProperty(n(t),x,{writable:!0,value:.3}),Object.defineProperty(n(t),Z,{writable:!0,value:Date.now()}),Object.defineProperty(n(t),z,{writable:!0,value:!1}),t.playerType=void 0,Object.defineProperty(n(t),M,{writable:!0,value:!0}),t.level=F.ONE,Object.defineProperty(n(t),V,{writable:!0,value:function(e){switch(e){case g.UP:a(n(t),j)[j].set(0,1),a(n(t),H)[H].setRotationFromEuler(p.UNIT_Z.clone().multiplyScalar(J.UP));break;case g.DOWN:a(n(t),j)[j].set(0,-1),a(n(t),H)[H].setRotationFromEuler(p.UNIT_Z.clone().multiplyScalar(J.DOWN));break;case g.LEFT:a(n(t),j)[j].set(-1,0),a(n(t),H)[H].setRotationFromEuler(p.UNIT_Z.clone().multiplyScalar(J.LEFT));break;case g.RIGHT:a(n(t),j)[j].set(1,0),a(n(t),H)[H].setRotationFromEuler(p.UNIT_Z.clone().multiplyScalar(J.RIGHT));break;case g.CANCEL:a(n(t),j)[j].set(0,0)}a(n(t),Y)[Y]()}}),Object.defineProperty(n(t),K,{writable:!0,value:function(){if(Date.now()-a(n(t),Z)[Z]>1e3*a(n(t),x)[x]){a(n(t),Z)[Z]=Date.now(),t.audio.effectPlay("shoot");var e=d(t.bulletPrefab);e.setPosition(t.node.position.clone()),e.setRotationFromEuler(a(n(t),H)[H].eulerAngles),e.setParent(a(n(t),W)[W]),e.getComponent(w).belongTo(t.playerType,t.canBrokenStone)}}}),t}i(t,e);var r=t.prototype;return r.onEnable=function(){a(this,G)[G]=this.getComponent(f),a(this,H)[H]=this.node.getChildByName("body"),a(this,_)[_]=a(this,H)[H].getComponent(y),this.updatePlayerTexture(),a(this,W)[W]=v("Canvas/game/Mask/bullets"),this.getComponent(b).on(P.BEGIN_CONTACT,this.onColliderHandle,this)},r.initGlobalLevel=function(e){this.level=e,this.updatePlayerTexture()},r.upPlayerLevel=function(e){void 0===e&&(e=1),this.level=T.clamp(this.level+e,F.ONE,F.FIVE),this.game.asyncPlayerLevel(this.playerType,this.level),this.updatePlayerTexture()},r.updatePlayerTexture=function(){var e=this.game.getTankUi(L[this.level]),t=this.animation.createAnimation(e);a(this,_)[_].defaultClip=t,a(this,H)[H].getComponent(m).spriteFrame=e.sfs[0]},r.onColliderHandle=function(e,t,i){var n=this;if(t.group===C.ENEMY||t.group===C.ENEMY_BULLET){var o;if(a(this,M)[M])return;if(this.level>F.ONE)return void this.upPlayerLevel(-1);this.getComponent(b).off(P.BEGIN_CONTACT,this.onColliderHandle,this),i.disabled=!0,a(this,z)[z]=!0,this.audio.effectPlay("player_bomb"),this.game.discountLife(this.playerType),a(this,j)[j].set(0,0),null==(o=v("Canvas").getComponent(N))||o.destroyAtPos(this.node.worldPosition,a(this,A)[A]),this.unBindStick(),this.scheduleOnce((function(){n.node.destroy()}))}},r.onDisable=function(){console.log("停止动画"),a(this,_)[_].pause()},r.bindStick=function(e,t){a(this,A)[A]=t,a(this,U)[U]=e,a(this,U)[U].on(E.EventType.TOUCHING,a(this,V)[V]),a(this,U)[U].on(E.EventType.SHOOTING,a(this,K)[K])},r.unBindStick=function(){a(this,U)[U]&&(a(this,U)[U].off(E.EventType.TOUCHING,a(this,V)[V]),a(this,U)[U].off(E.EventType.SHOOTING,a(this,K)[K]))},r.invincible=function(e){var t=this,i=this.node.getChildByName("invincible");i.active=!0,a(this,M)[M]=!0,this.scheduleOnce((function(){i.active=!1,a(t,M)[M]=!1}),e)},r.update=function(e){a(this,z)[z]||(a(this,G)[G].linearVelocity=new h(a(this,j)[j].x*this.speed*e,a(this,j)[j].y*this.speed*e))},r.onDestroy=function(){},l(t,[{key:"canBrokenStone",get:function(){return this.level>=F.FOUR}}]),t}(O)).prototype,"speed",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),R=t(S.prototype,"bulletPrefab",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=S))||I));function X(){0!==a(this,j)[j].length()?(a(this,_)[_].play(),this.audio.play("player_move")):(this.audio.stop(),a(this,_)[_].stop())}s._RF.pop()}}}));

System.register("chunks:///_virtual/Stick.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,n,o,r,a,c,l,h,s,p,f,u,y,d,T,C;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.assertThisInitialized,o=e.initializerDefineProperty,r=e.classPrivateFieldLooseBase,a=e.classPrivateFieldLooseKey},function(e){c=e.cclegacy,l=e._decorator,h=e.Enum,s=e.KeyCode,p=e.Node,f=e.Input,u=e.Vec3,y=e.NodeEventType,d=e.sys,T=e.input,C=e.Component}],execute:function(){var g,v,E,b,O,N,k,_,m,P,H,U,K,w,I,R,S,A,G,D,L,B,Y,z,F,W,j;c._RF.push({},"8738b/Qf5NKlK2nfmTuCTOP","Stick",void 0);var M=l.ccclass,x=l.property,V=(g=M("CTR_KEY"),v=x({type:h(s),displayName:"上"}),E=x({type:h(s),displayName:"下"}),b=x({type:h(s),displayName:"左"}),O=x({type:h(s),displayName:"右"}),N=x({type:h(s),displayName:"发射"}),g((m=t((_=function(){function e(){o(this,"up",m,this),o(this,"down",P,this),o(this,"left",H,this),o(this,"right",U,this),o(this,"fire",K,this)}return e.prototype.isCTRKey=function(e){return-1!==[this.up,this.down,this.left,this.right,this.fire].indexOf(e)},e}()).prototype,"up",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return s.KEY_W}}),P=t(_.prototype,"down",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return s.KEY_S}}),H=t(_.prototype,"left",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return s.KEY_A}}),U=t(_.prototype,"right",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return s.KEY_D}}),K=t(_.prototype,"fire",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return s.SPACE}}),k=_))||k),Q=e("TOWARDS",function(e){return e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT",e[e.CANCEL=4]="CANCEL",e}({}));e("Stick",(w=M("Stick"),I=x({type:V,displayName:"控制配置"}),R=x(p),w((B=a("areas"),Y=a("targetUser"),z=a("fireHandle"),F=a("onKeyDown"),W=a("onTouchStart"),j=a("onTouchEnd"),(L=function(e){function t(){for(var i,a=arguments.length,c=new Array(a),l=0;l<a;l++)c[l]=arguments[l];return i=e.call.apply(e,[this].concat(c))||this,Object.defineProperty(n(i),B,{writable:!0,value:[]}),o(i,"ctrKeyConfig",G,n(i)),o(i,"fireBtn",D,n(i)),Object.defineProperty(n(i),Y,{writable:!0,value:void 0}),i.hocker_idel=void 0,i.hocker_right=void 0,Object.defineProperty(n(i),z,{writable:!0,value:function(e){e.propagationStopped=!0,i.node.emit(t.EventType.SHOOTING)}}),Object.defineProperty(n(i),F,{writable:!0,value:function(e){if(e.type===f.EventType.KEY_UP&&i.ctrKeyConfig.isCTRKey(e.keyCode)){if(e.keyCode!==i.ctrKeyConfig.fire)return void i.node.emit(t.EventType.TOUCHING,Q.CANCEL);i.node.emit(t.EventType.SHOOTING)}switch(e.keyCode){case i.ctrKeyConfig.up:i.node.emit(t.EventType.TOUCHING,Q.UP);break;case i.ctrKeyConfig.down:i.node.emit(t.EventType.TOUCHING,Q.DOWN);break;case i.ctrKeyConfig.left:i.node.emit(t.EventType.TOUCHING,Q.LEFT);break;case i.ctrKeyConfig.right:i.node.emit(t.EventType.TOUCHING,Q.RIGHT)}}}),Object.defineProperty(n(i),W,{writable:!0,value:function(e){var o={top:{to:Q.UP,angle:90},down:{to:Q.DOWN,angle:-90},left:{to:Q.LEFT,angle:180},right:{to:Q.RIGHT,angle:0}}[e.currentTarget.name.replace(/.+-/,"")],a=o.to,c=o.angle;i.hocker_right.setRotationFromEuler(new u(0,0,c)),i.node.emit(t.EventType.TOUCHING,a),i.hocker_idel.active=!1,i.hocker_right.active=!0,console.log("stick turn",r(n(i),Y)[Y],a)}}),Object.defineProperty(n(i),j,{writable:!0,value:function(e){i.hocker_idel.active=!0,i.hocker_right.active=!1,i.node.emit(t.EventType.TOUCHING,Q.CANCEL)}}),i}i(t,e);var a=t.prototype;return a.onLoad=function(){r(this,B)[B].push(this.node.getChildByPath("hocker/hocker-tap-right"),this.node.getChildByPath("hocker/hocker-tap-top"),this.node.getChildByPath("hocker/hocker-tap-left"),this.node.getChildByPath("hocker/hocker-tap-down")),this.hocker_idel=this.node.getChildByPath("hocker/hocker-idel"),this.hocker_right=this.node.getChildByPath("hocker/hocker-right")},a.bindEvent=function(e){var t=this;void 0===e&&(e=!0),r(this,B)[B].forEach((function(i){e?(i.on(y.TOUCH_START,r(t,W)[W]),i.on(y.TOUCH_END,r(t,j)[j]),i.on(y.TOUCH_CANCEL,r(t,j)[j])):(i.off(y.TOUCH_START,r(t,W)[W]),i.off(y.TOUCH_END,r(t,j)[j]),i.off(y.TOUCH_CANCEL,r(t,j)[j]))}))},a.hidenVirUI=function(e){var t=d.isMobile||d.platform===d.Platform.WECHAT_MINI_PROGRAM;return this.fireBtn.active=t,this.node.getChildByName("hocker").active=t,d.dump(),console.log("设备类型：",t,r(this,B)[B].length),this},a.setUserType=function(e){r(this,Y)[Y]=e},a.onEnable=function(){d.isMobile?(this.fireBtn.on(y.TOUCH_START,r(this,z)[z]),this.bindEvent(!0)):(T.on(f.EventType.KEY_DOWN,r(this,F)[F]),T.on(f.EventType.KEY_UP,r(this,F)[F]))},a.onDisable=function(){this.fireBtn.off(y.TOUCH_START,r(this,z)[z]),T.off(f.EventType.KEY_DOWN,r(this,F)[F]),T.off(f.EventType.KEY_UP,r(this,F)[F]),this.bindEvent(!1)},t}(C)).EventType={TOUCHING:"touching",SHOOTING:"shooting"},G=t((A=L).prototype,"ctrKeyConfig",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new V}}),D=t(A.prototype,"fireBtn",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=A))||S));c._RF.pop()}}}));

System.register("chunks:///_virtual/toast.ts",["cc"],(function(t){var n;return{setters:[function(t){n=t.cclegacy}],execute:function(){n._RF.push({},"74b7crI5BxOi4mep/69rmgS","toast",void 0);var e=t("Toast",function(){function t(){var n=this;if(this.node=void 0,this.setupOnNode=function(t){n.node=t},t.instance)throw new Error("单例不允许多次初始化")}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.toast=function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];console.log.apply(null,n)},t}());e.instance=void 0;t("setup",e.getInstance().setupOnNode),t("toast",e.getInstance().toast);n._RF.pop()}}}));

System.register("chunks:///_virtual/ui-controler.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Base.ts","./GameMgr.ts","./game.conf.ts"],(function(e){var n,t,r,i,a,o,l,p,s,y,f,c,u,m,g,d,h,E;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.initializerDefineProperty,r=e.inheritsLoose,i=e.assertThisInitialized},function(e){a=e.cclegacy,o=e._decorator,l=e.SpriteFrame,p=e.Label,s=e.Node,y=e.Sprite,f=e.UITransform,c=e.find},function(e){u=e.Base},function(e){m=e.PlayerType,g=e.GameMode,d=e.GameMgr},function(e){h=e.ENEMY_TOTAL_PER_LEVEL,E=e.PLAYER_LIFE_TOTAL}],execute:function(){var _,L,T,v,b,S,C,A,P,F,z,N,w,D,R,I,M,Y,G,O,k,U,B,H,V,j,x;a._RF.push({},"fda811AlltLfLvULzM1J+9n","ui-controler",void 0);var J=o.ccclass,q=o.property,K=(_=J("tank_tag"),L=q({type:l,displayName:"敌机"}),T=q({type:l,displayName:"玩家"}),_((S=n((b=function(){t(this,"enemy",S,this),t(this,"player",C,this)}).prototype,"enemy",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=n(b.prototype,"player",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=b))||v),Q=(A=J("p_info"),P=q({type:p,displayName:"玩家分数"}),F=q({type:s,displayName:"生命数"}),A((w=n((N=function(){t(this,"score",w,this),t(this,"lifeTag",D,this)}).prototype,"score",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=n(N.prototype,"lifeTag",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=N))||z);e("ui_controler",(R=J("ui_controler"),I=q({type:p,displayName:"当前管卡"}),M=q({type:s,displayName:"剩余敌机"}),Y=q(K),G=q({type:Q,displayName:"玩家一"}),O=q({type:Q,displayName:"玩家二"}),R((B=n((U=function(e){function n(){for(var n,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return n=e.call.apply(e,[this].concat(a))||this,t(n,"stageLabel",B,i(n)),t(n,"enumTags",H,i(n)),t(n,"tankSpriteFrame",V,i(n)),t(n,"playerinfo_1",j,i(n)),t(n,"playerinfo_2",x,i(n)),n.playerScore=0,n.player2Score=0,n.enemyCount=30,n.playerlife=8,n.player2life=8,n.resetAll=function(){n.playerScore=n.player2Score=0,n.enemyCount=h,n.player2life=n.playerlife=E,n.playerinfo_1.lifeTag.removeAllChildren(),n.playerinfo_2.lifeTag.removeAllChildren(),n.enumTags.removeAllChildren(),n.onUpdateGameInfo()},n.discountPlayerLife=function(e){void 0===e&&(e=0),0===e?(n.playerlife--,n.removeLastChild(n.playerinfo_1.lifeTag)):(n.player2life--,n.removeLastChild(n.playerinfo_2.lifeTag))},n.addScore=function(e){var t=e.id,r=e.score;0===t?(n.playerScore+=r,n.playerinfo_1.score.string="积分: "+n.playerScore):(n.player2Score+=r,n.playerinfo_2.score.string="积分: "+n.player2Score)},n.changeLevel=function(e){n.stageLabel.string="关: "+e,n.enemyCount=h,n.createEnemyTags()},n.dicountEnemy=function(){n.enemyCount--,n.removeLastChild(n.enumTags)},n.createPlayerlife=function(e){var t=new s;t.addComponent(y).spriteFrame=n.tankSpriteFrame.player,t.getComponent(f).setContentSize(7,7),t.setParent(e===m.PLAYER_1?n.playerinfo_1.lifeTag:n.playerinfo_2.lifeTag)},n.onUpdateGameInfo=function(){n.createEnemyTags(),n.playerinfo_1.score.string="积分: "+n.playerScore;for(var e=0;e<n.playerlife;e++){var t=new s("player1_"+e);t.addComponent(y).spriteFrame=n.tankSpriteFrame.player,t.getComponent(f).setContentSize(7,7),t.setParent(n.playerinfo_1.lifeTag)}c("Canvas/ui/player-info/p2info").active=n.game.getMode()===g.DOUBLE,n.playerinfo_2.score.string="积分: "+n.player2Score;for(var r=0;r<n.player2life;r++){var i=new s("player2_"+r);i.addComponent(y).spriteFrame=n.tankSpriteFrame.player,i.getComponent(f).setContentSize(7,7),i.setParent(n.playerinfo_2.lifeTag)}},n}r(n,e);var a=n.prototype;return a.onEnable=function(){this.resetAll(),this.game.node.on(d.EventType.GAME_LEVEL_CHANGE,this.changeLevel),this.game.node.on(d.EventType.ENEMY_DISCOUNT,this.dicountEnemy),this.game.node.on(d.EventType.PLAYER_SCORE_ADD,this.addScore),this.game.node.on(d.EventType.PLAYER_LIFE_LOST,this.discountPlayerLife),this.game.node.on(d.EventType.RESET_ALL,this.resetAll),this.game.node.on(d.EventType.PLAYER_LIFE_ADD,this.createPlayerlife)},a.onDisable=function(){this.game.node.off(d.EventType.GAME_LEVEL_CHANGE,this.changeLevel),this.game.node.off(d.EventType.ENEMY_DISCOUNT,this.dicountEnemy),this.game.node.off(d.EventType.PLAYER_SCORE_ADD,this.addScore),this.game.node.off(d.EventType.PLAYER_LIFE_LOST,this.discountPlayerLife),this.game.node.off(d.EventType.RESET_ALL,this.resetAll),this.game.node.off(d.EventType.PLAYER_LIFE_ADD,this.createPlayerlife)},a.createEnemyTags=function(){this.enumTags.removeAllChildren();for(var e=0;e<this.enemyCount;e++){var n=new s("en_id_"+e);n.addComponent(y).spriteFrame=this.tankSpriteFrame.enemy,n.getComponent(f).setContentSize(7,7),n.setParent(this.enumTags)}},a.removeLastChild=function(e){e.children.length>0&&e.children[e.children.length-1].removeFromParent()},n}(u)).prototype,"stageLabel",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=n(U.prototype,"enumTags",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=n(U.prototype,"tankSpriteFrame",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new K}}),j=n(U.prototype,"playerinfo_1",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=n(U.prototype,"playerinfo_2",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=U))||k));a._RF.pop()}}}));

System.register("chunks:///_virtual/Util.ts",["cc","./index.mjs_cjs=&original=.js","./index.js"],(function(t){var c;return{setters:[function(t){c=t.cclegacy},null,function(c){t("Astar",c.default)}],execute:function(){c._RF.push({},"9e29caW2cpOQo+Ykw4Sl5ao","Util",void 0),c._RF.pop()}}}));

System.register("chunks:///_virtual/Win.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Base.ts"],(function(t){var n,e,o,r,i;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,r=t.director},function(t){i=t.Base}],execute:function(){var c;e._RF.push({},"4fd348YAblCQ77LFyHtsHjF","Win",void 0);var s=o.ccclass;o.property,t("Win",s("Win")(c=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var o=e.prototype;return o.start=function(){this.audio.stopAll()},o.gotoMenu=function(){r.loadScene("menu")},e}(i))||c);e._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});